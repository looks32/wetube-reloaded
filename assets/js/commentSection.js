(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=(document.querySelector(".video__comments ul"),document.querySelectorAll(".delete__icon")),a=async t=>{const n=t.target.parentElement,{dataset:{id:a}}=t.target.parentElement,o=e.dataset.id;200===(await fetch(`/api/videos/${o}/comment/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:a})})).status&&n.remove()};t&&t.addEventListener("submit",(async o=>{o.preventDefault();const d=t.querySelector("textarea"),c=d.value,s=e.dataset.id;if(""===c)return;const i=await fetch(`/api/videos/${s}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:c})});if(201===i.status){d.value="";const{newCommentId:e}=await i.json();((e,t)=>{const o=document.querySelector(".video__comments ul"),d=document.createElement("li");d.dataset.id=t,d.className="video__comment",n.className="delete__icon";const c=document.createElement("span");c.innerText=` ${e}`;const s=document.createElement("span");s.classList.add("delete__icon"),s.innerText="❌",d.appendChild(c),d.appendChild(s),o.prepend(d),n.addEventListener("click",a)})(c,e)}})),n&&n.forEach((e=>e.addEventListener("click",a)))})();