(()=>{const e=document.getElementById("videoContainer"),t=document.getElementById("commentForm"),n=(document.querySelector(".video__comments ul"),document.querySelectorAll(".delete__icon")),a=async t=>{const n=t.target.parentElement,{dataset:{id:a}}=t.target.parentElement,o=e.dataset.id;200===(await fetch(`/api/videos/${o}/comment/delete`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({commentId:a})})).status&&n.remove()};t&&t.addEventListener("submit",(async o=>{o.preventDefault();const c=t.querySelector("textarea"),d=c.value,m=e.dataset.id;if(""===d)return;const s=await fetch(`/api/videos/${m}/comment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:d})});if(201===s.status){c.value="";const{newCommentId:e}=await s.json();((e,t)=>{const o=document.querySelector(".video__comments ul"),c=document.createElement("li");c.dataset.id=t,c.className="video__comment";const d=document.createElement("i");d.className="fas fa-comment",n.className="delete__icon";const m=document.createElement("span");m.innerText=` ${e}`;const s=document.createElement("span");s.innerText="❌",c.appendChild(d),c.appendChild(m),c.appendChild(s),o.prepend(c),n.addEventListener("click",a)})(d,e)}})),n&&n.forEach((e=>e.addEventListener("click",a)))})();